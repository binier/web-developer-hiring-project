# Migration `20200910124707`

This migration has been generated by Zura Benashvili at 9/10/2020, 4:47:07 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Policy" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "number" TEXT NOT NULL,
    "annual_premium" REAL,
    "effective_date" DATETIME,
    "created" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
)

CREATE TABLE "State" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "policy_id" INTEGER NOT NULL,
    "status" TEXT NOT NULL,
    "reason" TEXT NOT NULL,
    "created" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY ("policy_id") REFERENCES "Policy"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Invoice" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "policy_id" INTEGER NOT NULL,
    "amount_due" REAL NOT NULL,
    "due_on" DATETIME NOT NULL,
    "created" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY ("policy_id") REFERENCES "Policy"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Payment" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "policy_id" INTEGER NOT NULL,
    "payment_amount" REAL NOT NULL,
    "created" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY ("policy_id") REFERENCES "Policy"("id") ON DELETE CASCADE ON UPDATE CASCADE
)
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200910124707
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,47 @@
+datasource db {
+  provider = "sqlite"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Policy {
+  id              Int      @id @default(autoincrement())
+  number          String
+  annual_premium  Float?
+  effective_date  DateTime?
+  created         DateTime @default(now())
+  updated         DateTime @default(now())
+  states          State[]
+}
+
+model State {
+  id        Int      @id @default(autoincrement())
+  policy_id Int
+  status    String
+  reason    String
+  created   DateTime @default(now())
+  updated   DateTime @default(now())
+  policy    Policy   @relation(fields: [policy_id], references: [id])
+}
+
+model Invoice {
+  id          Int      @id @default(autoincrement())
+  policy_id   Int
+  amount_due  Float
+  due_on      DateTime
+  created     DateTime @default(now())
+  updated     DateTime @default(now())
+  policy      Policy   @relation(fields: [policy_id], references: [id])
+}
+
+model Payment {
+  id              Int      @id @default(autoincrement())
+  policy_id       Int
+  payment_amount  Float
+  created         DateTime @default(now())
+  updated         DateTime @default(now())
+  policy          Policy   @relation(fields: [policy_id], references: [id])
+}
```


