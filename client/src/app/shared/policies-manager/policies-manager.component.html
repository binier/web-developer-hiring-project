<div class="w-full p-2 font-sans bg-purple-100 rounded-t">
  <span class="font-bold border-b-0">Policies</span>
</div>
<div class="overflow-x-auto">
  <app-policies-table
    [policies]="policies$ | async"
    (policyClick)="policyClick($event)"
    (sort)="sort$.next($event)"
  ></app-policies-table>
</div>
<div *ngIf="{ page: page$ | async, total: policiesTotalPages$ | async} as ctx" class="policies-pagination">
  <a (click)="setPage$.next(1)">{{ '<<' }}</a>
  <a (click)="setPage$.next(ctx.page - 1)">{{ '<' }}</a>
  <a *ngFor="let i of paginationPages$ | async" (click)="setPage$.next(i)" [class.current-page]="i === ctx.page">
    {{ i }}
  </a>
  <a (click)="setPage$.next(ctx.page + 1)">{{ '>' }}</a>
  <a (click)="setPage$.next(ctx.total)">{{ '>>' }}</a>
</div>

<app-modal #paymentsModel>
  <p class="text-2xl font-bold" header>Payments</p>
  <div *ngIf="(currentPolicy$ | async) as policy" body>
    <table>
      <tbody>
        <tr *ngFor="let payment of policy.payments">
          <td>
            {{payment.created | date}}
          </td>
          <td class="pl-8 font-bold">
            {{payment.payment_amount}}
          </td>
        </tr>
        <tr class="border-t-2">
          <td></td>
          <td class="pl-8 font-bold">
            {{paymentsSum(policy)}}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</app-modal>
